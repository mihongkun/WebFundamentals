<!DOCTYPE html>
<html devsite>

<head>
  <meta name="project_path" value="_project.yaml" />
  <meta name="book_path" value="_book.yaml" />
  <meta name="gtm_var" data-key="docType" data-value="reference">
  <title>Source: workbox-cli/src/lib/questions/ask-root-of-web-app.js</title>
  <link href="jsdoc.css" rel="stylesheet">
</head>

<body>
  <div id="jsdoc-body-container">
    <div id="jsdoc-content">
      <div id="jsdoc-content-container">
        <div id="jsdoc-banner" role="banner">
        </div>
        <div id="jsdoc-main" role="main">
          <header class="page-header">
            <h1>Source: workbox-cli/src/lib/questions/ask-root-of-web-app.js</h1>
          </header>
          <article>
            <pre class="prettyprint linenums"><code>const fs &#x3D; require(&#x27;fs&#x27;);
const inquirer &#x3D; require(&#x27;inquirer&#x27;);
const path &#x3D; require(&#x27;path&#x27;);


const constants &#x3D; require(&#x27;../constants&#x27;);
const logHelper &#x3D; require(&#x27;../log-helper&#x27;);
const errors &#x3D; require(&#x27;../errors&#x27;);

/**
 * This method requests the root directory of the web app.
 * The user can opt to type in the directory OR select &#x3D; require(a list of
 * directories in the current path.
 * @return {Promise&amp;lt;string&gt;} Promise that resolves with the name of the root
 * directory if given.
 */
module.exports &#x3D; () &#x3D;&gt; {
  const manualEntryChoice &#x3D; &#x27;Manually Enter Path&#x27;;
  const currentDirectory &#x3D; process.cwd();

  return new Promise((resolve, reject) &#x3D;&gt; {
    fs.readdir(currentDirectory, (err, directoryContents) &#x3D;&gt; {
      if (err) {
        return reject(err);
      }

      resolve(directoryContents);
    });
  })
  .then((directoryContents) &#x3D;&gt; {
    return directoryContents.filter((directoryContent) &#x3D;&gt; {
      return fs.statSync(directoryContent).isDirectory();
    });
  })
  .then((subdirectories) &#x3D;&gt; {
    return subdirectories.filter((subdirectory) &#x3D;&gt; {
      // Strip black listed directories from options.
      if (constants.blacklistDirectoryNames.includes(subdirectory)) {
        return false;
      }

      // Strip hidden directories from options.
      if (subdirectory.indexOf(&#x27;.&#x27;) &#x3D;&#x3D;&#x3D; 0) {
        return false;
      }

      return true;
    });
  })
  .then((subdirectories) &#x3D;&gt; {
    if (subdirectories.length &gt; 0) {
      // There are subdirectories we can set for the root of the project.
      const choices &#x3D; subdirectories.concat([
        new inquirer.Separator(),
        manualEntryChoice,
      ]);
      return inquirer.prompt([
        {
          name: &#x27;rootDir&#x27;,
          message: &#x27;What is the root of your web app?&#x27;,
          type: &#x27;list&#x27;,
          choices: choices,
        },
        {
          name: &#x27;rootDir&#x27;,
          message: &#x27;Please manually enter the root of your web app?&#x27;,
          when: (answers) &#x3D;&gt; {
            return answers.rootDir &#x3D;&#x3D;&#x3D; manualEntryChoice;
          },
        },
      ]);
    } else {
      // There are no subdirectories so the developer must manually define this.
      return inquirer.prompt([
        {
          name: &#x27;rootDir&#x27;,
          message: &#x27;Please enter the root of your web app? (Defaults to &#x27; +
            &#x27;the current directory)&#x27;,
          default: &#x27;.&#x27;,
        },
      ]);
    }
  })
  .then((answers) &#x3D;&gt; {
    return path.join(currentDirectory, answers.rootDir);
  })
  .catch((err) &#x3D;&gt; {
    logHelper.error(
      errors[&#x27;unable-to-get-rootdir&#x27;],
      err
    );
    throw err;
  });
};
</code></pre>
          </article>
        </div>
      </div>
      <nav id="jsdoc-toc-nav" role="navigation"></nav>
    </div>
  </div>
</body>

</html>