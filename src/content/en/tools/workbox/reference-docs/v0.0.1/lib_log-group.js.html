<!DOCTYPE html>
<html devsite>

<head>
  <meta name="project_path" value="_project.yaml" />
  <meta name="book_path" value="_book.yaml" />
  <meta name="gtm_var" data-key="docType" data-value="reference">
  <title>Source: lib/log-group.js</title>
  <link href="jsdoc.css" rel="stylesheet">
</head>

<body>
  <div id="jsdoc-body-container">
    <div id="jsdoc-content">
      <div id="jsdoc-content-container">
        <div id="jsdoc-banner" role="banner">
        </div>
        <div id="jsdoc-main" role="main">
          <header class="page-header">
            <h1>Source: lib/log-group.js</h1>
          </header>
          <article>
            <pre class="prettyprint linenums"><code>/* eslint-disable no-console */

/**
 * A simple helper to manage the print of a set of logs
 */
class LogGroup {
  /**
   * @param {object} input
   * @param {string} input.title
   * @param {boolean} input.isPrimary
   */
  constructor({title, isPrimary} &#x3D; {}) {
    this._isPrimary &#x3D; isPrimary || false;
    this._groupTitle &#x3D; title || &#x27;&#x27;;
    this._logs &#x3D; [];
    this._childGroups &#x3D; [];

    this._isFirefox &#x3D; false;
    if (/Firefox\/\d*\.\d*/.exec(navigator.userAgent)) {
      this._isFirefox &#x3D; true;
    }

    this._isEdge &#x3D; false;
    if (/Edge\/\d*\.\d*/.exec(navigator.userAgent)) {
      this._isEdge &#x3D; true;
    }
  }

  /**
   *@param {object} logDetails
   */
  addLog(logDetails) {
    this._logs.push(logDetails);
  }

  /**
   * @param {object} group
   */
  addChildGroup(group) {
    if (group._logs.length &#x3D;&#x3D;&#x3D; 0) {
      return;
    }

    this._childGroups.push(group);
  }

  /**
   * prints out this log group to the console.
   */
  print() {
    if (this._isEdge) {
      this._printEdgeFriendly();
      return;
    }

    this._openGroup();

    this._logs.forEach((logDetails) &#x3D;&gt; {
      this._printLogDetails(logDetails);
    });

    this._childGroups.forEach((group) &#x3D;&gt; {
      group.print();
    });

    this._closeGroup();
  }

  /**
   * This prints a simpler log for Edge which has poor group support.
   * For more details see:
   * https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/11363242/
   */
  _printEdgeFriendly() {
    // Edge has no support for colors at all and poor support for groups.
    this._logs.forEach((logDetails, index) &#x3D;&gt; {
      // Message can be an object - i.e. an error.
      let message &#x3D; logDetails.message;
      if (typeof message &#x3D;&#x3D;&#x3D; &#x27;string&#x27;) {
        // Replace the %c value with an empty string.
        message &#x3D; message.replace(/%c/g, &#x27;&#x27;);
      }
      const logArgs &#x3D; [message];
      if (logDetails.error) {
        logArgs.push(logDetails.error);
      }
      if (logDetails.args) {
        logArgs.push(logDetails.args);
      }
      const logFunc &#x3D; logDetails.logFunc || console.log;
      logFunc(...logArgs);
    });

    this._childGroups.forEach((group, index) &#x3D;&gt; {
       group.print();
    });
  }

  /**
   * Prints the specific logDetails object.
   * @param {object} logDetails
   */
  _printLogDetails(logDetails) {
    const logFunc &#x3D; logDetails.logFunc ? logDetails.logFunc : console.log;
    let message &#x3D; logDetails.message;
    let allArguments &#x3D; [message];
    if (logDetails.colors &amp;amp;&amp;amp; !this._isEdge) {
      allArguments &#x3D; allArguments.concat(logDetails.colors);
    }
    if (logDetails.args) {
      allArguments &#x3D; allArguments.concat(logDetails.args);
    }
    logFunc(...allArguments);
  }

  /**
   * Opens a console group - managing differences in Firefox.
   */
  _openGroup() {
    if (this._isPrimary) {
      // Only start a group is there are child groups
      if (this._childGroups.length &#x3D;&#x3D;&#x3D; 0) {
        return;
      }

      const logDetails &#x3D; this._logs.shift();
      if (this._isFirefox) {
        // Firefox doesn&#x27;t support colors logs in console.group.
        this._printLogDetails(logDetails);
        return;
      }

      // Print the colored message with console.group
      logDetails.logFunc &#x3D; console.group;
      this._printLogDetails(logDetails);
    } else {
      console.groupCollapsed(this._groupTitle);
    }
  }

  /**
   * Closes a console group
   */
  _closeGroup() {
    // Only close a group if there was a child group opened
    if (this._isPrimary &amp;amp;&amp;amp; this._childGroups.length &#x3D;&#x3D;&#x3D; 0) {
      return;
    }

    console.groupEnd();
  }
}

export default LogGroup;
</code></pre>
          </article>
        </div>
      </div>
      <nav id="jsdoc-toc-nav" role="navigation"></nav>
    </div>
  </div>
</body>

</html>